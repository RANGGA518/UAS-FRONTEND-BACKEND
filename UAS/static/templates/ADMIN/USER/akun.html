<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Akun Saya</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg bg-white shadow-sm sticky-top">
    <div class="container">

        <!-- BRAND -->
        <a class="navbar-brand fw-bold text-primary me-3" href="/">
            Minimarket
        </a>

        <!-- TOGGLER (MOBILE) -->
        <button class="navbar-toggler" type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarMain"
                aria-controls="navbarMain"
                aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- COLLAPSE AREA -->
        <div class="collapse navbar-collapse" id="navbarMain">

            <!-- SEARCH -->
            <div class="mx-lg-auto my-3 my-lg-0 w-100 d-flex justify-content-center position-relative">

                {% if pesan %}
                <div id="searchNotif" class="search-floating-alert">
                    <div class="alert alert-warning text-center shadow-sm mb-0">
                        {{ pesan }}
                    </div>
                </div>
                {% endif %}

                <form
                    action="{{ request.path }}"
                    method="get"
                    class="d-flex align-items-center search-wrapper w-100"
                    style="max-width:600px;"
                    onsubmit="return handleSearch(this)">

                    <input type="search"
                           name="q"
                           class="form-control search-input"
                           placeholder="Cari produk..."
                           value="{{ keyword or '' }}">

                    <button type="submit" class="btn btn-primary search-btn ms-2">
                        <i class="bi bi-search"></i>
                    </button>
                </form>
            </div>

            <!-- RIGHT MENU -->
            <div class="d-flex align-items-center gap-3 ms-lg-4">

                <!-- CART -->
                <a href="/cart" class="position-relative text-decoration-none text-dark">
                    <i class="bi bi-cart3 fs-4"></i>
                    {% if cart_count > 0 %}
                    <span class="cart-badge">{{ cart_count }}</span>
                    {% endif %}
                </a>

                {% if session.get("user") %}
                <a href="/profile" class="user-profile d-flex align-items-center text-decoration-none text-dark">
                    <img src="{{ url_for('static', filename='img/user/images.png') }}" width="32" height="32" class="rounded-circle me-2">
                    <span class="fw-semibold">
                        Hi,&nbsp;{{ session.user }}
                    </span>
                </a>
                {% else %}
                <a href="/login" class="btn btn-outline-primary btn-sm">Masuk</a>
                <a href="/register" class="btn btn-primary btn-sm">Daftar</a>
                {% endif %}

            </div>

        </div>
    </div>
</nav>
    <div class="container mt-5">
        <div class="card shadow-sm mx-auto" style="max-width: 450px;">
            <div class="card-body text-center">

                <img src="{{ url_for('static', filename='img/user/images.png') }}" width="90" class="rounded-circle mb-3">

                <h5 class="fw-bold mb-0">{{ user.username }}</h5>
                <p class="text-muted">{{ user.email }}</p>

                <hr>

                <div class="text-start">
                    <p><strong>Username:</strong> {{ user.username }}</p>
                    <p><strong>Email:</strong> {{ user.email }}</p>
                </div>

                <div class="d-flex justify-content-between mt-4">
                    <a href="/" class="btn btn-outline-secondary">Kembali</a>

                    <a href="/logout" onclick="return confirm('Yakin ingin logout?')" class="btn btn-danger">
                        Logout
                    </a>
                </div>
            </div>
        </div>
    </div>

<script>
    function handleSearch(form) {
    const input = form.querySelector('input[name="q"]');

    // kalau kosong â†’ stay di halaman sekarang
    if (!input.value.trim()) {
        return false;
    }

    return true;
}
    const notif = document.getElementById("searchNotif");

    if (notif) {
        setTimeout(() => {
            notif.style.opacity = "0";
            notif.style.transform = "translateY(-10px)";

            setTimeout(() => {
                notif.remove();
            }, 300);

        }, 3000);
    }
</script>
</body>
</html>